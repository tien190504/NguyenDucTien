---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Tag from "../../components/Tag.astro";
import { getCollection } from "astro:content";

const base = import.meta.env.BASE_URL;
const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<BaseLayout title="Blog" description="Writing about frontend, SEO, and product delivery.">
  <section class="section">
    <div class="container-prose space-y-8">
      <div class="space-y-3">
        <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-500 dark:text-slate-400">Notes</p>
        <h1 class="text-3xl font-semibold text-slate-900 dark:text-white">Blog</h1>
        <p class="text-slate-600 dark:text-slate-300">
          Short essays on building modern, SEO-friendly multi-page sites.
        </p>
      </div>
      <div class="grid gap-6 md:grid-cols-2">
        {posts.map((post) => (
          <article class="card flex h-full flex-col gap-4 p-6">
            <div class="text-xs text-slate-500 dark:text-slate-300">
              {post.data.date.toLocaleDateString("en-US", {
                year: "numeric",
                month: "short",
                day: "numeric"
              })}
            </div>
            <h2 class="text-xl font-semibold text-slate-900 dark:text-white">{post.data.title}</h2>
            <p class="text-sm text-slate-600 dark:text-slate-300">{post.data.description}</p>
            <div class="flex flex-wrap gap-2">
              {post.data.tags.map((tag) => (
                <Tag label={tag} />
              ))}
            </div>
            <a class="mt-auto text-sm font-semibold text-accent-600" href={`${base}blog/${post.slug}/`}>
              Read post ->
            </a>
          </article>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>

